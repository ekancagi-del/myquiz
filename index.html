<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ken, what kind of Barbie do you unlock today? ðŸ’–</title>

  <style>
    :root{
      --pink:#ff5fa2;
      --purple:#9b7bff;
      --bg1:#ffeaf6;
      --bg2:#efe7ff;
      --card: rgba(255,255,255,.78);
      --stroke: rgba(255,255,255,.72);
      --text:#2a1033;
      --muted:#7a4a8a;
      --shadow: 0 18px 60px rgba(45,10,70,.14);
      --radius: 26px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      color:var(--text);
      background:
        radial-gradient(1100px 680px at 15% 10%, rgba(255,95,162,.30), transparent 55%),
        radial-gradient(1100px 680px at 85% 20%, rgba(155,123,255,.25), transparent 55%),
        linear-gradient(135deg, var(--bg1), var(--bg2));
      min-height:100vh;
      display:flex;
      justify-content:center;
      padding:22px;
    }
    .wrap{width:min(900px,100%); display:grid; gap:14px;}

    .topbar{
      display:flex; align-items:center; justify-content:space-between; gap:10px;
      padding:12px 14px; border-radius: 20px;
      background: rgba(255,255,255,.55);
      border:1px solid var(--stroke);
      box-shadow: 0 10px 28px rgba(45,10,70,.10);
      backdrop-filter: blur(12px);
    }
    .brand{display:flex; align-items:center; gap:12px; min-width:0;}
    .logo{
      width:42px;height:42px;border-radius:16px;
      background: linear-gradient(135deg, var(--pink), var(--purple));
      display:grid;place-items:center;
      box-shadow: 0 14px 26px rgba(255,95,162,.16);
      flex:0 0 auto;
    }
    .logo span{font-size:20px; filter: drop-shadow(0 8px 10px rgba(0,0,0,.10));}
    .brand h1{
      margin:0; font-size:14.5px; letter-spacing:-0.01em;
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .brand p{
      margin:2px 0 0; font-size:12px; color:var(--muted);
      white-space:nowrap; overflow:hidden; text-overflow:ellipsis;
    }
    .pill{
      display:flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.70);
      border:1px solid var(--stroke);
      color:var(--muted); font-size:12px; flex:0 0 auto;
    }
    .dot{
      width:9px;height:9px;border-radius:999px;
      background: linear-gradient(135deg, var(--pink), var(--purple));
      box-shadow: 0 0 0 4px rgba(255,95,162,.12);
    }

    .card{
      background: var(--card);
      border: 1px solid var(--stroke);
      border-radius: var(--radius);
      padding: 22px;
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      position:relative;
      overflow:hidden;
    }
    .card::after{
      content:"";
      position:absolute;
      inset:-120px auto auto -120px;
      width:260px;height:260px;border-radius:50%;
      background:
        radial-gradient(circle at 35% 35%, rgba(255,95,162,.25), transparent 60%),
        radial-gradient(circle at 70% 70%, rgba(155,123,255,.22), transparent 60%);
      transform: rotate(18deg);
      pointer-events:none;
    }

    .stickerWrap{display:flex; justify-content:center; margin: 4px 0 14px;}
    .sticker{
      width:min(310px, 78%); height:auto; border-radius:18px;
      filter: drop-shadow(0 18px 26px rgba(45,10,70,.18));
      user-select:none; -webkit-user-drag:none;
    }

    /* HOME */
    .homeTitle{
      font-size:32px; line-height:1.05; margin:0 0 10px;
      letter-spacing:-0.02em; text-align:center;
    }
    .homeSub{
      margin:0 auto 10px; color:var(--muted); font-size:14.5px;
      line-height:1.55; max-width: 72ch; text-align:center;
    }
    .sweetLine{
      margin: 0 auto 14px;
      max-width: 72ch;
      text-align:center;
      font-size:13px;
      color: rgba(122,74,138,.95);
      background: rgba(255,255,255,.68);
      border: 1px solid var(--stroke);
      padding: 10px 12px;
      border-radius: 999px;
      width: fit-content;
    }

    .cuteChips{display:flex; gap:8px; flex-wrap:wrap; margin:10px 0 0; justify-content:center;}
    .chip{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.75);
      border:1px solid var(--stroke);
      font-size:12px; color:var(--muted);
    }
    .chip b{color:#3a1247;}
    .ctaRow{display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:center; margin-top:14px;}
    .btn{
      border:0; cursor:pointer; border-radius:999px;
      padding:12px 18px;
      background: linear-gradient(135deg, var(--pink), var(--purple));
      color:#fff; font-weight:900; font-size:14px;
      box-shadow: 0 14px 28px rgba(255,95,162,.18);
      transition: transform .12s ease, filter .12s ease;
    }
    .btn:hover{transform:translateY(-1px); filter:saturate(1.05);}
    .btn:active{transform:translateY(0px) scale(.99);}
    .btn.secondary{
      background: rgba(255,255,255,.78);
      color:var(--text);
      border:1px solid var(--stroke);
      box-shadow:none;
    }
    .note{margin-top:12px; color:var(--muted); font-size:12.5px; line-height:1.45; text-align:center;}

    /* QUIZ */
    .quiz{display:none;}
    .progressWrap{display:flex; align-items:center; gap:10px; margin-bottom:10px;}
    .progress{
      height:10px; background: rgba(255,255,255,.65);
      border:1px solid var(--stroke);
      border-radius:999px; overflow:hidden; flex:1;
    }
    .progress div{
      height:100%; width:0%;
      background: linear-gradient(135deg, var(--pink), var(--purple));
      border-radius:999px; transition: width .22s ease;
    }
    .counter{font-size:12px; color:var(--muted); white-space:nowrap;}
    .qTitle{font-size:22px; margin:0 0 10px; letter-spacing:-0.01em; line-height:1.25;}
    .answers{display:grid; gap:12px;}
    .answer{
      background: rgba(255,255,255,.80);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:14px 14px;
      cursor:pointer;
      box-shadow: 0 10px 22px rgba(45,10,70,.08);
      transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    }
    .answer:hover{transform: translateY(-1px); background: rgba(255,255,255,.90); box-shadow: 0 14px 26px rgba(45,10,70,.11);}
    .answer:active{transform: translateY(0px) scale(.995);}
    .footerRow{display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; margin-top:12px;}
    .tinyBtn{
      border: 1px solid var(--stroke);
      background: rgba(255,255,255,.70);
      color: var(--muted);
      padding:10px 12px;
      border-radius:999px;
      cursor:pointer;
      font-weight:900;
      font-size:12.5px;
    }
    .tinyBtn:hover{background: rgba(255,255,255,.82);}

    /* RESULT */
    .result{display:none;}
    .tag{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      background: rgba(255,255,255,.78);
      border:1px solid var(--stroke);
      color:var(--muted); font-size:12px;
      width:fit-content; margin: 0 auto;
    }
    .resultTitle{
      margin:10px 0 10px; font-size:30px;
      letter-spacing:-0.02em; line-height:1.05; text-align:center;
    }
    .resultText{
      margin:0 auto; color:var(--muted); font-size:15px;
      line-height:1.6; max-width: 76ch; text-align:center;
    }
    .resultBlock{
      margin:14px auto 0; max-width:76ch;
      padding:14px 14px; border-radius:18px;
      background: rgba(255,255,255,.72);
      border:1px solid var(--stroke);
      color:#3a1247; font-size:13.5px; line-height:1.6;
      text-align:center;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"><span>ðŸ’–</span></div>
        <div style="min-width:0">
          <h1>Ken, what kind of Barbie do you unlock today?</h1>
          <p>Answer honestly, Ken. Barbie notices the details.</p>
        </div>
      </div>
      <div class="pill"><span class="dot" aria-hidden="true"></span><span>Today</span></div>
    </div>

    <!-- HOME -->
    <section class="card" id="home">
      <div class="stickerWrap">
        <img class="sticker" src="both.png" alt="Ken & Barbie sticker" />
      </div>

      <h2 class="homeTitle">Hi Ken. ðŸ’—</h2>
      <p class="homeSub">
        This is a tiny 24-hour vibe check. Youâ€™re not being graded like homework â€”
        Barbie is just deciding what energy sheâ€™s serving you today ðŸ˜Œ
      </p>

      <div class="sweetLine" id="homeLine">ðŸŽ€ One minute. One mood. Donâ€™t fumble, Ken.</div>

      <div class="cuteChips">
        <div class="chip">ðŸŽ² 5 daily-ish questions</div>
        <div class="chip">ðŸ«§ Some answers areâ€¦ risky in disguise</div>
        <div class="chip">ðŸ’— Barbie can be Cute or Fasti (orâ€¦ almost)</div>
      </div>

      <div class="ctaRow">
        <button class="btn" id="startBtn">Start âœ¨</button>
        <button class="btn secondary" id="reshuffleBtn" title="New random set for this run">New questions ðŸŽ²</button>
      </div>

      <p class="note">
        Reminder: teasing is allowed. But making Barbie feel small? Thatâ€™s how you summon Fasti Barbie.
      </p>
    </section>

    <!-- QUIZ -->
    <section class="card quiz" id="quiz" aria-live="polite">
      <div class="progressWrap">
        <div class="progress"><div id="bar"></div></div>
        <div class="counter" id="counter">Question 1 of 5</div>
      </div>

      <div class="sweetLine" id="quizLine">ðŸ’— Be honest. Barbie can tell when youâ€™re bluffing.</div>
      <h3 class="qTitle" id="q">Question</h3>
      <div class="answers" id="answers"></div>

      <div class="footerRow">
        <button class="tinyBtn" id="restartBtn">Restart ðŸ”„</button>
        <button class="tinyBtn" id="backBtn">Back â†©ï¸Ž</button>
      </div>
    </section>

    <!-- RESULT -->
    <section class="card result" id="result">
      <div class="stickerWrap">
        <img class="sticker" id="resultSticker" src="cute.png" alt="Result sticker" />
      </div>

      <div class="sweetLine" id="resultLine">âœ¨ Barbie has decided. Donâ€™t argue with the glitter.</div>

      <div class="tag" id="tag">ðŸ’ž Result</div>
      <h2 class="resultTitle" id="title">Today Barbie isâ€¦</h2>
      <p class="resultText" id="text"></p>
      <div class="resultBlock" id="extra"></div>

      <div class="ctaRow" style="margin-top:14px">
        <button class="btn" id="againBtn">Play again ðŸŽ€</button>
        <button class="btn secondary" id="homeBtn">Back to start</button>
      </div>

      <p class="note" id="closingNote"></p>
    </section>
  </div>

  <script>
    const PER_RUN = 5;

    // Sweet one-liners (shown before each question page render)
    const LINES = [
      "ðŸŽ€ Choose wisely, Ken. Barbie is taking notes in glitter ink.",
      "ðŸ’— Today counts. Tomorrow is a different vibe.",
      "âœ¨ Be honest. Barbie can smell excuses from Spain to London.",
      "ðŸ«§ Softness is a skill. Donâ€™t pretend you donâ€™t have it.",
      "ðŸ˜Œ Teasing is cuteâ€¦ until it isnâ€™t. You know the difference.",
      "ðŸ’ž If youâ€™re unsure, pick the option that wouldnâ€™t annoy Barbie.",
      "ðŸŽ€ This is not a test. Itâ€™s a vibe audit.",
      "âœ¨ One good message can save your whole day, Ken."
    ];

    // Scoring model:
    // Each answer has both C and F (grey on purpose).
    // We also add a tiny "daily risk" factor to make outcomes less predictable.
    //
    // Final outcomes:
    // - Cute Barbie
    // - Cute Barbie (could flip to Fasti if you mess up)
    // - Fasti Barbie
    // - Fasti Barbie (but you can recover fast)
    //
    // We do NOT show score. Only the vibe label + cute message.

    const QUESTIONS = [
      // More "daily" and time-based questions (today / last 24 hours)
      {
        q:"In the last 24 hours, your teasing was mostlyâ€¦",
        a:[
          {t:"Light and affectionate â€” you made Barbie laugh with you.", c:0.62, f:0.38},
          {t:"Confident teasingâ€¦ then you softened it with flirting.", c:0.59, f:0.41},
          {t:"A bit bold, but you read the vibe and adjusted.", c:0.57, f:0.43},
          {t:"More â€˜chaos energyâ€™ than usual (but not malicious).", c:0.55, f:0.45},
        ]
      },
      {
        q:"Today, when Barbie sent something cute, youâ€¦",
        a:[
          {t:"Noticed a detail and said it out loud.", c:0.62, f:0.38},
          {t:"Reacted first, then came back properly later.", c:0.58, f:0.42},
          {t:"Kept it cool, but didnâ€™t ignore it.", c:0.57, f:0.43},
          {t:"Took your timeâ€¦ but your reply was warm.", c:0.59, f:0.41},
        ]
      },
      {
        q:"Todayâ€™s reply timing wasâ€¦",
        a:[
          {t:"Steady â€” Barbie didnâ€™t have to guess.", c:0.61, f:0.39},
          {t:"A little chaotic, but you still checked in.", c:0.57, f:0.43},
          {t:"Quiet at times, but you returned with warmth.", c:0.58, f:0.42},
          {t:"Busy day â€” you did one meaningful message.", c:0.59, f:0.41},
        ]
      },
      {
        q:"If Barbie felt slightly sensitive today, youâ€¦",
        a:[
          {t:"Switched to soft mode immediately.", c:0.62, f:0.38},
          {t:"Teased lightly, then reassured.", c:0.58, f:0.42},
          {t:"Waited for her cue before joking.", c:0.60, f:0.40},
          {t:"Did one risky jokeâ€¦ but you were ready to stop.", c:0.56, f:0.44},
        ]
      },
      {
        q:"The â€˜ugly stickerâ€™ situation (today or recently): if it happened, it wasâ€¦",
        a:[
          {t:"A ridiculous one you also use on yourself â€” fair chaos.", c:0.59, f:0.41},
          {t:"Only when the vibe was playful, never when sheâ€™s down.", c:0.62, f:0.38},
          {t:"Once for the laugh, then you followed with sweetness.", c:0.57, f:0.43},
          {t:"A bold moveâ€¦ but you thought it would land today.", c:0.55, f:0.45},
        ]
      },
      {
        q:"Today, if Barbie was a bit annoyed, youâ€¦",
        a:[
          {t:"Softened your tone and kept it easy.", c:0.61, f:0.39},
          {t:"Did one light joke, then got calm and present.", c:0.58, f:0.42},
          {t:"Gave space, but stayed warm.", c:0.59, f:0.41},
          {t:"Waited, then came back with a better vibe.", c:0.57, f:0.43},
        ]
      },
      {
        q:"In the last day, you made Barbie feelâ€¦",
        a:[
          {t:"Seen. Like you actually noticed her.", c:0.62, f:0.38},
          {t:"Wanted â€” in a calm, confident way.", c:0.60, f:0.40},
          {t:"Entertained â€” even if a bit chaotic.", c:0.57, f:0.43},
          {t:"Curious â€” like youâ€™re building tension.", c:0.58, f:0.42},
        ]
      },
      {
        q:"Todayâ€™s flirting level wasâ€¦",
        a:[
          {t:"Simple but effective (no cringe).", c:0.60, f:0.40},
          {t:"Playful and a bit teasing.", c:0.58, f:0.42},
          {t:"Low-key, but real.", c:0.59, f:0.41},
          {t:"Late, but stronger when it arrived.", c:0.57, f:0.43},
        ]
      },
      {
        q:"If Barbie said â€œI miss youâ€ today, your reply would beâ€¦",
        a:[
          {t:"Immediate softness, no games.", c:0.62, f:0.38},
          {t:"Flirtyâ€¦ but you still mean it.", c:0.59, f:0.41},
          {t:"Warm, but you keep it cool.", c:0.58, f:0.42},
          {t:"A little later, but extra sweet.", c:0.59, f:0.41},
        ]
      },
      {
        q:"Kenâ€™s â€˜red obsessionâ€™ moment ðŸ”´ today wasâ€¦",
        a:[
          {t:"A quick inside joke, then you moved on like a prince.", c:0.58, f:0.42},
          {t:"Dramatic for 2 seconds, then you laughed.", c:0.56, f:0.44},
          {t:"Cute and harmless â€” not a whole personality.", c:0.60, f:0.40},
          {t:"A red alertâ€¦ but you made Barbie feel included.", c:0.59, f:0.41},
        ]
      },
      {
        q:"Today, when Barbie said something important, youâ€¦",
        a:[
          {t:"Replied in a way that showed you got it.", c:0.61, f:0.39},
          {t:"Asked one follow-up question.", c:0.60, f:0.40},
          {t:"Reacted fast, reflected later.", c:0.57, f:0.43},
          {t:"Kept it short but stayed present.", c:0.58, f:0.42},
        ]
      },
      {
        q:"If Barbie was quiet today, youâ€¦",
        a:[
          {t:"Checked in once, then gave space.", c:0.60, f:0.40},
          {t:"Waited a bit, then asked calmly.", c:0.59, f:0.41},
          {t:"Sent something light to reset the vibe.", c:0.57, f:0.43},
          {t:"Stayed chill and didnâ€™t overthink.", c:0.58, f:0.42},
        ]
      },
      {
        q:"If a joke landed wrong today, youâ€¦",
        a:[
          {t:"Fixed it quickly and softened the moment.", c:0.62, f:0.38},
          {t:"Said â€˜okay, my badâ€™ and adjusted.", c:0.61, f:0.39},
          {t:"Let it breathe, then came back gentle.", c:0.58, f:0.42},
          {t:"Smoothed it over with extra sweetness after.", c:0.59, f:0.41},
        ]
      },
      {
        q:"Today your â€˜effort levelâ€™ wasâ€¦",
        a:[
          {t:"Small but consistent (quietly impressive).", c:0.60, f:0.40},
          {t:"A bit chaotic, but the intention was real.", c:0.57, f:0.43},
          {t:"Low-key â€” youâ€™ll make up for it soon.", c:0.55, f:0.45},
          {t:"High effort in the moments that mattered.", c:0.61, f:0.39},
        ]
      },
      {
        q:"Today, if you used teasing, it was mostly becauseâ€¦",
        a:[
          {t:"You were flirting and you kept it soft.", c:0.59, f:0.41},
          {t:"It was genuinely funny and you wanted her to laugh.", c:0.60, f:0.40},
          {t:"You were bored and chose respectful chaos.", c:0.56, f:0.44},
          {t:"You liked the reaction a bit too much (danger).", c:0.54, f:0.46},
        ]
      },
      {
        q:"If Barbie called you â€œannoyingâ€ today, youâ€¦",
        a:[
          {t:"Backed off a little and came back nicer.", c:0.60, f:0.40},
          {t:"Asked â€˜annoying or cute annoying?â€™ (risky).", c:0.55, f:0.45},
          {t:"Pretended youâ€™re innocent, then softened.", c:0.57, f:0.43},
          {t:"Fixed it without drama.", c:0.61, f:0.39},
        ]
      },
      {
        q:"Today, your compliments wereâ€¦",
        a:[
          {t:"Specific and believable.", c:0.61, f:0.39},
          {t:"Short but effective.", c:0.59, f:0.41},
          {t:"Flirty but not overdone.", c:0.60, f:0.40},
          {t:"Rareâ€¦ but youâ€™ll do it later.", c:0.56, f:0.44},
        ]
      },
      {
        q:"If Barbie had a stressful moment today, youâ€¦",
        a:[
          {t:"Stayed steady and calm in your tone.", c:0.61, f:0.39},
          {t:"Lightened the mood first, then got serious.", c:0.58, f:0.42},
          {t:"Gave space but stayed warm.", c:0.59, f:0.41},
          {t:"Asked what she needed (and followed it).", c:0.62, f:0.38},
        ]
      },
      {
        q:"Todayâ€™s â€˜distanceâ€™ (London â†” Spain) vibe wasâ€¦",
        a:[
          {t:"You made it feel smaller with consistency.", c:0.61, f:0.39},
          {t:"You were busy, but still present.", c:0.59, f:0.41},
          {t:"A bit quiet â€” but warm when you showed up.", c:0.57, f:0.43},
          {t:"You leaned into mystery today.", c:0.56, f:0.44},
        ]
      },
      {
        q:"In the last 24 hours, your energy wasâ€¦",
        a:[
          {t:"Warm and playful.", c:0.60, f:0.40},
          {t:"Chill but caring.", c:0.59, f:0.41},
          {t:"Confident and a bit teasing.", c:0.58, f:0.42},
          {t:"Chaotic but cute about it.", c:0.56, f:0.44},
        ]
      },
      // More daily â€œmicro-behaviorâ€ prompts:
      {
        q:"Today, your â€˜check-inâ€™ wasâ€¦",
        a:[
          {t:"A real one â€” not just an emoji drive-by.", c:0.61, f:0.39},
          {t:"Short, but it showed intention.", c:0.59, f:0.41},
          {t:"You forgot once, but you came back warm.", c:0.56, f:0.44},
          {t:"You stayed quiet and hoped sheâ€™d feel it telepathically.", c:0.54, f:0.46},
        ]
      },
      {
        q:"If you teased Barbie about her photo today, it wasâ€¦",
        a:[
          {t:"A soft joke that still made her feel pretty.", c:0.61, f:0.39},
          {t:"A bold joke, but you followed with a compliment.", c:0.58, f:0.42},
          {t:"A â€˜you had to be thereâ€™ joke (risk).", c:0.56, f:0.44},
          {t:"You didnâ€™t tease â€” you were sweet today.", c:0.62, f:0.38},
        ]
      },
      {
        q:"Today, you handled her mood byâ€¦",
        a:[
          {t:"Matching her energy respectfully.", c:0.60, f:0.40},
          {t:"Keeping it playful, but ready to switch soft.", c:0.58, f:0.42},
          {t:"Being calm and stable.", c:0.61, f:0.39},
          {t:"Letting her lead while you stayed warm.", c:0.59, f:0.41},
        ]
      },
      {
        q:"If Barbie gave you a hint today (like â€˜be niceâ€™), youâ€¦",
        a:[
          {t:"Actually listened and adjusted.", c:0.61, f:0.39},
          {t:"Listenedâ€¦ after one last joke (risky).", c:0.56, f:0.44},
          {t:"Kept it calm and sweet.", c:0.60, f:0.40},
          {t:"Didnâ€™t fully clock it, but you meant well.", c:0.55, f:0.45},
        ]
      },
      {
        q:"Today, the vibe of your teasing wasâ€¦",
        a:[
          {t:"â€˜Laugh WITH meâ€™ not â€˜laugh AT youâ€™.", c:0.62, f:0.38},
          {t:"A bit sharp at first, softer after.", c:0.57, f:0.43},
          {t:"Mostly fine, borderline sometimes.", c:0.56, f:0.44},
          {t:"You didnâ€™t tease â€” you were cute today.", c:0.61, f:0.39},
        ]
      }
    ];

    // UI
    const homeEl = document.getElementById("home");
    const quizEl = document.getElementById("quiz");
    const resultEl = document.getElementById("result");

    const qEl = document.getElementById("q");
    const answersEl = document.getElementById("answers");
    const counterEl = document.getElementById("counter");
    const barEl = document.getElementById("bar");

    const tagEl = document.getElementById("tag");
    const titleEl = document.getElementById("title");
    const textEl = document.getElementById("text");
    const extraEl = document.getElementById("extra");
    const closingNoteEl = document.getElementById("closingNote");
    const resultStickerEl = document.getElementById("resultSticker");

    const homeLineEl = document.getElementById("homeLine");
    const quizLineEl = document.getElementById("quizLine");
    const resultLineEl = document.getElementById("resultLine");

    const startBtn = document.getElementById("startBtn");
    const reshuffleBtn = document.getElementById("reshuffleBtn");
    const restartBtn = document.getElementById("restartBtn");
    const backBtn = document.getElementById("backBtn");
    const againBtn = document.getElementById("againBtn");
    const homeBtn = document.getElementById("homeBtn");

    let run = [];
    let idx = 0;
    let cute = 0;
    let fasti = 0;

    // A tiny randomness to mimic "today's mood" so the same answers
    // can land slightly different across days.
    function dailyMoodNoise(){
      // between -0.04 and +0.04
      return (Math.random() * 0.08) - 0.04;
    }

    function shuffle(arr){
      const a = arr.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(Math.random()*(i+1));
        [a[i],a[j]]=[a[j],a[i]];
      }
      return a;
    }

    function pickLine(){
      return LINES[Math.floor(Math.random() * LINES.length)];
    }

    function pickRun(){
      run = shuffle(QUESTIONS).slice(0, PER_RUN);
      idx = 0;
      cute = 0;
      fasti = 0;
      homeLineEl.textContent = pickLine();
    }

    function render(){
      counterEl.textContent = `Question ${idx+1} of ${PER_RUN}`;
      barEl.style.width = Math.round((idx / PER_RUN) * 100) + "%";

      quizLineEl.textContent = pickLine();

      const q = run[idx];
      qEl.textContent = q.q;
      answersEl.innerHTML = "";

      const shuffledAnswers = shuffle(q.a);
      for(const opt of shuffledAnswers){
        const div = document.createElement("div");
        div.className = "answer";
        div.textContent = opt.t;
        div.onclick = () => {
          // Add small daily noise so the same patterns aren't always identical
          const n = dailyMoodNoise();
          cute += (opt.c + n);
          fasti += (opt.f - n);

          idx++;
          if(idx >= PER_RUN) finish();
          else render();
        };
        answersEl.appendChild(div);
      }
    }

    function finish(){
      barEl.style.width = "100%";
      quizEl.style.display = "none";
      resultEl.style.display = "block";
      resultLineEl.textContent = pickLine();

      const diff = cute - fasti;

      // Four vibe labels (2 main + "could flip" flavor):
      // - Cute Barbie (stable)
      // - Cute Barbie (could flip to Fasti)
      // - Fasti Barbie (stable)
      // - Fasti Barbie (but could recover to Cute)
      //
      // Thresholds tuned to make Fasti easier than before.
      const CUTE_STABLE = 0.22;
      const CUTE_BORDER = 0.06;  // if diff is between 0.06 and 0.22 -> Cute but could flip
      const FASTI_BORDER = -0.10; // if diff between -0.10 and 0.06 -> Fasti-ish zone (recoverable)
      // diff <= -0.10 -> stable fasti

      const vibe =
        (diff >= CUTE_STABLE) ? "CUTE_STABLE" :
        (diff >= CUTE_BORDER) ? "CUTE_CLOSE_TO_FASTI" :
        (diff > FASTI_BORDER) ? "FASTI_CLOSE_TO_CUTE" :
        "FASTI_STABLE";

      if(vibe === "FASTI_STABLE"){
        resultStickerEl.src = "fasti.png";
        tagEl.textContent = "ðŸ˜Œ Fasti Barbie (stable)";
        titleEl.textContent = "Today Barbie is Fasti ðŸ˜Œ";
        textEl.textContent =
          "Kenâ€¦ today Barbieâ€™s patience is on airplane mode. You werenâ€™t horrible, you were justâ€¦ a little too confident with the teasing, " +
          "or a little too casual with the effort. Barbie noticed.";
        extraEl.textContent =
          "For the next 24 hours: if you want softness, you need to earn it. " +
          "No â€˜ugly stickerâ€™ crimes, no random disappearing, no playful disrespect. " +
          "One sincere compliment + one warm check-in is the minimum entry fee.";
        closingNoteEl.textContent =
          "You can recover tomorrow. Today? Move carefully, Ken.";
      }

      if(vibe === "FASTI_CLOSE_TO_CUTE"){
        resultStickerEl.src = "fasti.png";
        tagEl.textContent = "ðŸ˜Œ Fasti Barbie (but you can recover)";
        titleEl.textContent = "Today Barbie is Fastiâ€¦ but itâ€™s reversible ðŸ˜ŒðŸ’—";
        textEl.textContent =
          "Kenâ€¦ Barbie is *slightly* fasti today, but not fully locked in. " +
          "This is the kind of day where one good message can flip the whole vibe. " +
          "Youâ€™re closer to Cute than you think â€” if you stop playing it cool.";
        extraEl.textContent =
          "For the next 24 hours: keep teasing gentle, add softness immediately after, and do one thoughtful check-in. " +
          "If you were the â€˜ugly stickerâ€™ Ken todayâ€¦ you owe a real compliment, not a â€˜lolâ€™.";
        closingNoteEl.textContent =
          "Do the right thing and Barbie might switch to Cute *mid-day*. No pressure.";
      }

      if(vibe === "CUTE_CLOSE_TO_FASTI"){
        resultStickerEl.src = "cute.png";
        tagEl.textContent = "ðŸ’— Cute Barbie (but donâ€™t get comfortable)";
        titleEl.textContent = "Today Barbie is Cuteâ€¦ but she can flip ðŸ˜ŒðŸ’—";
        textEl.textContent =
          "Okay Kenâ€¦ you unlocked Cute Barbie today. But it was close. " +
          "You did enough sweetness to win the day, but the teasing-to-softness ratio wasâ€¦ suspiciously balanced.";
        extraEl.textContent =
          "For the next 24 hours: you get affection, flirting, and extra patience â€” for now. " +
          "But one poorly-timed joke, one unnecessary sticker, or one â€˜disappear and come back like nothing happenedâ€™ " +
          "and Barbie will switch modes instantly.";
        closingNoteEl.textContent =
          "If you want to secure â€˜fully Cuteâ€™: one thoughtful check-in at the right time. Thatâ€™s the spell.";
      }

      if(vibe === "CUTE_STABLE"){
        resultStickerEl.src = "cute.png";
        tagEl.textContent = "ðŸ’— Cute Barbie (stable)";
        titleEl.textContent = "Today Barbie is Cute ðŸ’•";
        textEl.textContent =
          "Kenâ€¦ today your energy feels safe and wanted. Not perfect, not scripted â€” just genuinely sweet in the moments that mattered. " +
          "Barbie feels seen. Thatâ€™s the whole secret.";
        extraEl.textContent =
          "For the next 24 hours: youâ€™re getting maximum Cute Barbie. Extra softness. Extra flirting. Extra warmth. " +
          "Just donâ€™t do anything dramatic for no reason (you know yourself).";
        closingNoteEl.textContent =
          "If you want to keep this tomorrow too: consistency + one thoughtful check-in. Easy. Donâ€™t sabotage it, Ken.";
      }

      window.scrollTo({top:0, behavior:"smooth"});
    }

    function start(){
      pickRun();
      homeEl.style.display = "none";
      resultEl.style.display = "none";
      quizEl.style.display = "block";
      render();
      window.scrollTo({top:0, behavior:"smooth"});
    }

    function goHome(){
      quizEl.style.display = "none";
      resultEl.style.display = "none";
      homeEl.style.display = "block";
      homeLineEl.textContent = pickLine();
      window.scrollTo({top:0, behavior:"smooth"});
    }

    // Buttons
    startBtn.onclick = start;
    reshuffleBtn.onclick = () => pickRun();
    restartBtn.onclick = start;
    backBtn.onclick = goHome;
    againBtn.onclick = start;
    homeBtn.onclick = goHome;

    // Init
    pickRun();
  </script>
</body>
</html>


